# CUTRIX è£å‰ªè½¦é—´ç®¡ç†ç³»ç»Ÿ

ä¸€ä¸ªåŸºäº Go + React Web çš„ç°ä»£åŒ–è£å‰ªè½¦é—´ç®¡ç†ç³»ç»Ÿï¼Œå®ç°äº†ä»ç”Ÿäº§è®¡åˆ’ä¸‹è¾¾åˆ°è£å‰ªæ‰“åŒ…å®Œæˆçš„å…¨æµç¨‹æ•°å­—åŒ–è¿½è¸ªã€‚

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### åç«¯ (Backend)
- **è¯­è¨€**: Go 1.24+
- **Webæ¡†æ¶**: Gin
- **æ•°æ®åº“**: PostgreSQL 15
- **æ•°æ®åº“é©±åŠ¨**: pgx + sqlx
- **é…ç½®ç®¡ç†**: Viper
- **å®¹å™¨åŒ–**: Docker

### å‰ç«¯ (Frontend)
- **æ¡†æ¶**: React 18 + TypeScript
- **æ„å»ºå·¥å…·**: Vite
- **UIç»„ä»¶åº“**: Ant Design
- **çŠ¶æ€ç®¡ç†**: Zustand
- **ç½‘ç»œè¯·æ±‚**: Axios
- **è·¯ç”±**: React Router Dom

### éƒ¨ç½²æ–¹æ¡ˆ
- **å¼€å‘ç¯å¢ƒ**: Docker Compose + å‰ç«¯å¼€å‘æœåŠ¡å™¨
- **ç”Ÿäº§ç¯å¢ƒ**: Go åç«¯ç›´æ¥æ‰˜ç®¡é™æ€æ–‡ä»¶
- **æ•°æ®åº“**: PostgreSQL 15 å®¹å™¨åŒ–éƒ¨ç½²

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚
- Node.js 18+
- Docker & Docker Compose
- Git

### å®‰è£…æ­¥éª¤

1. **å…‹éš†é¡¹ç›®**
   ```bash
   git clone <your-repo-url>
   cd CUTRIX
   ```

2. **ä¸€é”®æ„å»ºå’Œå¯åŠ¨**
   
   **Windows:**
   ```cmd
   build.bat
   ```
   
   **Linux/macOS:**
   ```bash
   chmod +x build.sh
   ./build.sh
   ```

3. **è®¿é—®åº”ç”¨**
   - åº”ç”¨åœ°å€: http://localhost:8080
   - API å¥åº·æ£€æŸ¥: http://localhost:8080/health

### å¼€å‘æ¨¡å¼

å¦‚æœä½ éœ€è¦åŒæ—¶å¼€å‘å‰åç«¯ï¼š

1. **å¯åŠ¨åç«¯æœåŠ¡**
   ```bash
   docker-compose up -d postgres  # åªå¯åŠ¨æ•°æ®åº“
   cd backend
   go run cmd/main.go
   ```

2. **å¯åŠ¨å‰ç«¯å¼€å‘æœåŠ¡å™¨**
   ```bash
   cd web-frontend
   npm install
   npm run dev
   ```

3. **è®¿é—®åœ°å€**
   - å‰ç«¯å¼€å‘æœåŠ¡å™¨: http://localhost:3000
   - åç«¯ API: http://localhost:8080

## ğŸ“ é¡¹ç›®ç»“æ„

```
CUTRIX/
â”œâ”€â”€ backend/                 # Go åç«¯æœåŠ¡
â”‚   â”œâ”€â”€ cmd/main.go         # åº”ç”¨å…¥å£
â”‚   â”œâ”€â”€ internal/           # ä¸šåŠ¡é€»è¾‘
â”‚   â”‚   â”œâ”€â”€ handlers/       # HTTP å¤„ç†å™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ fabric_log_worker_handlers.go  # å¸ƒåŒ¹/æ—¥å¿—/å‘˜å·¥å¤„ç†å™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ order_handler.go              # è®¢å•å¤„ç†å™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ style_handler.go              # æ¬¾å·å¤„ç†å™¨
â”‚   â”‚   â”‚   â””â”€â”€ task_handler.go               # ä»»åŠ¡å¤„ç†å™¨
â”‚   â”‚   â”œâ”€â”€ services/       # ä¸šåŠ¡æœåŠ¡
â”‚   â”‚   â”‚   â”œâ”€â”€ fabric_log_worker_services.go # å¸ƒåŒ¹/æ—¥å¿—/å‘˜å·¥æœåŠ¡
â”‚   â”‚   â”‚   â”œâ”€â”€ order_service.go              # è®¢å•æœåŠ¡
â”‚   â”‚   â”‚   â”œâ”€â”€ style_service.go              # æ¬¾å·æœåŠ¡
â”‚   â”‚   â”‚   â””â”€â”€ task_service.go               # ä»»åŠ¡æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ repositories/   # æ•°æ®è®¿é—®å±‚
â”‚   â”‚   â”œâ”€â”€ models/         # æ•°æ®æ¨¡å‹
â”‚   â”‚   â””â”€â”€ config/         # é…ç½®ç®¡ç†
â”‚   â”œâ”€â”€ pkg/               # å…¬å…±åŒ…
â”‚   â”‚   â”œâ”€â”€ database/      # æ•°æ®åº“è¿æ¥
â”‚   â”‚   â””â”€â”€ middleware/    # ä¸­é—´ä»¶
â”‚   â”œâ”€â”€ migrations/        # æ•°æ®åº“è¿ç§»
â”‚   â””â”€â”€ web/              # é™æ€æ–‡ä»¶ç›®å½•ï¼ˆæ„å»ºæ—¶åˆ›å»ºï¼‰
â”œâ”€â”€ web-frontend/          # React Web å‰ç«¯
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/    # React ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ pages/         # é¡µé¢ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ services/      # API æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ store/         # çŠ¶æ€ç®¡ç†
â”‚   â”‚   â””â”€â”€ types/         # TypeScript ç±»å‹
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ vite.config.ts
â”œâ”€â”€ docker-compose.yml     # å¼€å‘ç¯å¢ƒé…ç½®
â”œâ”€â”€ build.sh / build.bat   # æ„å»ºè„šæœ¬
â””â”€â”€ README.md
```

## ğŸ”§ å¸¸ç”¨å‘½ä»¤

```bash
# æ„å»ºå¹¶å¯åŠ¨æ•´ä¸ªåº”ç”¨
npm run build

# å¼€å‘æ¨¡å¼ï¼ˆå‰åç«¯åŒæ—¶å¯åŠ¨ï¼‰
npm run dev

# åªå¯åŠ¨åç«¯
npm run dev:backend

# åªå¯åŠ¨å‰ç«¯
npm run dev:frontend

# å¯åŠ¨ Docker æœåŠ¡
npm run docker:up

# åœæ­¢ Docker æœåŠ¡
npm run docker:down

# æŸ¥çœ‹åç«¯æ—¥å¿—
npm run docker:logs

# æ¸…ç†æ„å»ºæ–‡ä»¶
npm run clean
```

## ğŸ“Š æ ¸å¿ƒåŠŸèƒ½

### å·²å®ç°
- âœ… **æ¬¾å·ç®¡ç†** - åˆ›å»ºå’ŒæŸ¥çœ‹æ¬¾å·
- âœ… **ç”Ÿäº§ä»»åŠ¡ç®¡ç†** - åˆ›å»ºä»»åŠ¡ï¼Œå®æ—¶è¿›åº¦è¿½è¸ª
- âœ… **æ•°æ®åº“è§¦å‘å™¨** - è‡ªåŠ¨æ›´æ–°å®Œæˆå±‚æ•°
- âœ… **é™æ€æ–‡ä»¶æ‰˜ç®¡** - Go åç«¯ç›´æ¥æœåŠ¡å‰ç«¯
- âœ… **å“åº”å¼ UI** - åŸºäº Ant Design çš„ç°ä»£ç•Œé¢

### å¼€å‘ä¸­
- ğŸš§ **å¸ƒåŒ¹ç®¡ç†** - å¸ƒåŒ¹æ³¨å†Œå’ŒçŠ¶æ€è¿½è¸ª
- ğŸš§ **ç”Ÿäº§è®°å½•** - è¯¦ç»†çš„æ“ä½œæ—¥å¿—
- ğŸš§ **å‘˜å·¥ç®¡ç†** - å‘˜å·¥ä¿¡æ¯å’Œä»»åŠ¡åˆ†é…

## ğŸ”„ å‡çº§è·¯å¾„ - ä»å½“å‰æ¶æ„åˆ°é«˜æ€§èƒ½æ¶æ„

å½“ä¸šåŠ¡å‘å±•åˆ°éœ€è¦æ›´é«˜æ€§èƒ½æ—¶ï¼Œå¯ä»¥æŒ‰ä»¥ä¸‹è·¯å¾„å‡çº§ï¼š

### ç¬¬ä¸€é˜¶æ®µï¼šå½“å‰æ¶æ„ï¼ˆé€‚åˆæ—¥è®¿é—®é‡ < 10ä¸‡ï¼‰
```
æµè§ˆå™¨ â†’ Go åç«¯ (8080) â†’ PostgreSQL
         â”œâ”€â”€ /api/*  â†’ REST API  
         â””â”€â”€ /*      â†’ é™æ€æ–‡ä»¶
```

**ä¼˜åŠ¿**: éƒ¨ç½²ç®€å•ã€ç»´æŠ¤æˆæœ¬ä½
**é€‚ç”¨**: ä¸­å°å‹å›¢é˜Ÿã€å¿«é€ŸåŸå‹

### ç¬¬äºŒé˜¶æ®µï¼šç‹¬ç«‹ Web æœåŠ¡å™¨ï¼ˆé€‚åˆæ—¥è®¿é—®é‡ 10ä¸‡+ï¼‰
```
æµè§ˆå™¨ â†’ Nginx (80/443)
         â”œâ”€â”€ /api/*  â†’ Go åç«¯ (8080)
         â””â”€â”€ /*      â†’ é™æ€æ–‡ä»¶ç›®å½•
```

**å‡çº§æ­¥éª¤**:
1. å®‰è£… Nginx
2. é…ç½®åå‘ä»£ç†
3. å°†é™æ€æ–‡ä»¶éƒ¨ç½²åˆ° Nginx ç›®å½•
4. å‰ç«¯ä»£ç æ— éœ€ä¿®æ”¹

**Nginx é…ç½®ç¤ºä¾‹**:
```nginx
server {
    listen 80;
    
    # é™æ€æ–‡ä»¶
    location / {
        root /var/www/cutrix/dist;
        try_files $uri $uri/ /index.html;
    }
    
    # API åå‘ä»£ç†
    location /api/ {
        proxy_pass http://localhost:8080;
        proxy_set_header Host $host;
    }
}
```

### ç¬¬ä¸‰é˜¶æ®µï¼šå¾®æœåŠ¡æ¶æ„ï¼ˆé€‚åˆå¤§è§„æ¨¡åº”ç”¨ï¼‰
```
æµè§ˆå™¨ â†’ API ç½‘å…³ â†’ å¤šä¸ª Go å¾®æœåŠ¡
                   â”œâ”€â”€ ç”¨æˆ·æœåŠ¡
                   â”œâ”€â”€ è®¢å•æœåŠ¡  
                   â”œâ”€â”€ åº“å­˜æœåŠ¡
                   â””â”€â”€ æ—¥å¿—æœåŠ¡
```

**å‡çº§è¦ç‚¹**:
- æŒ‰ä¸šåŠ¡åŸŸæ‹†åˆ†æœåŠ¡
- å¼•å…¥æ¶ˆæ¯é˜Ÿåˆ—
- å®ç°åˆ†å¸ƒå¼é“¾è·¯è¿½è¸ª

## ğŸ”§ API æ–‡æ¡£

### åŸºç¡€URL
- å¼€å‘ç¯å¢ƒ: `http://localhost:8080/api`
- ç”Ÿäº§ç¯å¢ƒ: `https://your-domain.com/api`

### ä¸»è¦æ¥å£

#### æ¬¾å·ç®¡ç†
- `POST /api/styles` - åˆ›å»ºæ¬¾å·
- `GET /api/styles` - è·å–æ¬¾å·åˆ—è¡¨
- `GET /api/styles/:id` - è·å–æ¬¾å·è¯¦æƒ…

#### è®¢å•ç®¡ç†
- `POST /api/orders` - å½•å…¥è®¢å•æ˜ç»†
- `GET /api/orders` - è·å–è®¢å•åˆ—è¡¨
- `GET /api/orders/:id` - è·å–è®¢å•è¯¦æƒ…

#### ç”Ÿäº§ä»»åŠ¡ç®¡ç†
- `POST /api/tasks` - åˆ›å»ºç”Ÿäº§ä»»åŠ¡
- `GET /api/tasks` - è·å–ä»»åŠ¡åˆ—è¡¨
- `GET /api/tasks/:id` - è·å–ä»»åŠ¡è¯¦æƒ…
- `GET /api/tasks/progress` - è·å–ä»»åŠ¡è¿›åº¦

#### å¸ƒåŒ¹ç®¡ç†
- `POST /api/fabric-rolls` - æ³¨å†Œå¸ƒåŒ¹
- `GET /api/fabric-rolls` - è·å–å¸ƒåŒ¹åˆ—è¡¨
- `GET /api/fabric-rolls/:id` - è·å–å¸ƒåŒ¹è¯¦æƒ…

#### ç”Ÿäº§è®°å½•
- `POST /api/production-logs` - è®°å½•ç”Ÿäº§æ“ä½œ
- `GET /api/production-logs` - è·å–ç”Ÿäº§è®°å½•

#### å‘˜å·¥ç®¡ç†
- `GET /api/workers` - è·å–å‘˜å·¥åˆ—è¡¨
- `GET /api/workers/:id/tasks` - è·å–å‘˜å·¥ä»»åŠ¡åˆ—è¡¨

## ğŸ—„ï¸ æ•°æ®åº“è®¾è®¡

ç³»ç»Ÿé‡‡ç”¨6å¼ æ ¸å¿ƒè¡¨ï¼š

1. **Styles** - æ¬¾å·è¡¨
2. **Order_Details** - è®¢å•æ˜ç»†è¡¨
3. **Production_Tasks** - ç”Ÿäº§ä»»åŠ¡è¡¨
4. **Fabric_Rolls** - å¸ƒåŒ¹è¡¨
5. **Production_Logs** - ç”Ÿäº§è®°å½•è¡¨
6. **Workers** - å‘˜å·¥è¡¨

### å…³é”®æœºåˆ¶
- é€šè¿‡æ•°æ®åº“è§¦å‘å™¨è‡ªåŠ¨æ±‡æ€»completed_layerså­—æ®µ
- ä½¿ç”¨parent_log_idå»ºç«‹å·¥åºè¿½è¸ªé“¾
- å¸ƒåŒ¹IDé‡‡ç”¨[æ¬¾å·]-[é¢œè‰²]-[åºå·]æ ¼å¼ç”Ÿæˆ

## ğŸ›¡ï¸ å®‰å…¨è€ƒè™‘

- JWT Token è®¤è¯ï¼ˆé¢„ç•™æ¥å£ï¼‰
- å‚æ•°åŒ–æŸ¥è¯¢é˜²æ­¢ SQL æ³¨å…¥
- CORS è·¨åŸŸä¿æŠ¤
- è¾“å…¥éªŒè¯å’Œè¿‡æ»¤

## ğŸ› æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **ç«¯å£è¢«å ç”¨**
   ```bash
   # æ£€æŸ¥ç«¯å£å ç”¨
   netstat -tlnp | grep 8080
   # ä¿®æ”¹ docker-compose.yml ä¸­çš„ç«¯å£æ˜ å°„
   ```

2. **å‰ç«¯æ„å»ºå¤±è´¥**
   ```bash
   # æ¸…ç†ä¾èµ–é‡æ–°å®‰è£…
   cd web-frontend
   rm -rf node_modules package-lock.json
   npm install
   ```

3. **æ•°æ®åº“è¿æ¥å¤±è´¥**
   ```bash
   # æ£€æŸ¥ Docker æœåŠ¡çŠ¶æ€
   docker-compose ps
   # æŸ¥çœ‹æ•°æ®åº“æ—¥å¿—
   docker-compose logs postgres
   ```